# 如何将图形显示到屏幕上

## 渲染与光栅化

### 显示器

在计算机图形学中通常称“屏幕”为**光栅设备**或者叫**光栅显示器**，光栅设备由二维**像素**阵列组成，每个像素有固定的**位置**和**颜色值**。颜色值不一定非得是彩色的，如黑白。一个光栅设备最直观的例子就是点阵屏，你在路上看到的led点阵屏就是一种光栅设备。光栅设备通过**控制每个像素的颜色**值来显示图形，通过**刷新每个像素的颜色值**来更新图形，其分辨率由固定的像素限制。

与光栅设备相对的是**矢量显示器**，它控制电子束在屏幕上**绘制线条**，这些线条是**连续的矢量路径**，而非由像素拼凑而成。其颜色一般是单一的颜色，因为其电子和荧光粉材料一般不会变化（通过电子激发荧光粉发光显示图形），示波器就是一种矢量显示器。通过重新控制电子的偏移（类似示波器原理（高中都学过吧））来更新图形。分辨率理论上无限受限于电子束精度。

| 特性       | 光栅显示器       | 矢量显示器                 |
| ---------- | ---------------- | -------------------------- |
| 显示方式   | 控制像素的颜色值 | 控制电子束的便宜激发荧光粉 |
| 分辨率     | 受像素多少决定   | 理论上无限，受电子束精度   |
| 更新方式   | 刷新像素颜色值   | 控制电子束偏移             |
| 图形连续性 | 离散             | 连续                       |

### 渲染

**渲染**是将抽象出来的**三维场景**转化为**二维图形**的整个过程。

如一个立方体由8个三维顶点，6个三维平面构成，但是我们的显示器是二维的，想要将其在显示器上显示的前提是将其二维化。就像我们要在纸上画一个立方体都是画的其二维投影图。

### 光栅化

**光栅化**是将连续的二维**几何图元**（如点、线、三角形）转换为离散的**屏幕像素**（即“填充像素”）的具体算法或过程。光栅化是渲染的子集。渲染的方式不不仅仅只有光栅化，还有**光线追踪**，**路径追踪**，**光线投射**（放心这个系列都会讲）。



## 方式

通过渲染我们就能将我们想要的图形显示在我们的屏幕上了。

不过作为现代人，**想直接控制屏幕的每一个像素其实并不容易**。出于安全和多任务的考虑，操作系统不会允许程序随意改写显存。但我们仍可以通过图形 API（比如 OpenGL、Vulkan等)（放心我的其他系列会教）再交给系统显示出来。但是秉持着如无必要勿增实体的原则我们不使用这种方式。

我们不直接操作显示器的像素，我们控制图片的数据来进行我们的学习。图片就是我们的**光栅设备**图片的大小就是图片的高度*宽度就是像素个数。

这里我们使用一种特殊的图片格式 **ppm 格式**，这种格式非常简单，是一种纯文本的图片格式。常用于计算机图形学教学之中。

ppm通常有两种编码模式

- p3模式： ASCII 文本格式，将RGB以10进制写入
- p6模式：二进制格式，将RGB以十六进制写入

p3模式编码方式

```
# 文件开头写编码模式
P3
# 编码模式下一行写图片尺寸（分辨率）
2 2
# 图片尺寸下一行写颜色值范围
255
#然后写入颜色值
255 0 0 255 0 0 255 0 0 255 0 0
```

缺点没有 Alpha 通道

